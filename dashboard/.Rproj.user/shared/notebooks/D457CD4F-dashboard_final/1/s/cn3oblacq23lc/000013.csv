"0","data1$week_bins <- cut(data1$weeks_on_board, breaks = seq(0, 40, by = 5))"
"0",""
"0","frequency_counts <- data1 %>%"
"0","  group_by(week_bins) %>%"
"0","  summarise(sum = n())  # n() counts the number of observations in each group"
"0",""
"0","# Compute the cumulative percentages"
"0","frequency_counts$fraction <- frequency_counts$sum / sum(frequency_counts$sum)"
"0","frequency_counts$ymax <- cumsum(frequency_counts$fraction)"
"0","frequency_counts$ymin <- c(0, head(frequency_counts$ymax, n=-1))"
"0","frequency_counts$labelPosition <- (frequency_counts$ymax + frequency_counts$ymin) / 2"
"0","frequency_counts$label <- paste0(frequency_counts$week_bins, "" weeks\n"", frequency_counts$sum, "" songss\n"")"
"0",""
"0","# Create the plot"
"0","plot_ly(frequency_counts, type = ""pie"", hole = 0.6,"
"0","        labels = ~week_bins, values = ~sum, text = ~label,"
"0","        hoverinfo = ""percent+value"","
"0","        marker = list(colors = viridis::plasma(length(frequency_counts$sum))),"
"0","        textposition = ""inside"","
"0","        textinfo = ""text"","
"0","        domain = list(x = c(0, 1), y = c(0, 1))) %>%"
"0","  layout(showlegend = FALSE)"
